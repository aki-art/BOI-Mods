<shaders>
    <shader name="ES_GrayScale">
        <parameters>
            <param name="Strength" type="float"/>
        </parameters>
        <vertex><![CDATA[

            attribute vec3 Position; 
            attribute vec4 Color; 
            attribute vec2 TexCoord; 
            attribute vec4 RenderData; 
            attribute float Scale;
            attribute float Strength;

            varying vec4 Color0; 
            varying vec2 TexCoord0; 
            varying vec4 RenderDataOut; 
            varying float ScaleOut;
            uniform mat4 Transform; 
            varying float StrengthOut;

            void main(void)
            {
                RenderDataOut = RenderData;
                ScaleOut = Scale;
                StrengthOut = Strength;
                TexCoord0 = TexCoord;
                Color0 = Color;
                gl_Position = Transform * vec4(Position.xyz, 1.0);
            }
        ]]></vertex>
        <fragment><![CDATA[
            varying lowp vec4 Color0; 
            varying mediump vec2 TexCoord0; 
            varying lowp vec4 RenderDataOut;
            varying lowp float ScaleOut; 
            uniform sampler2D Texture0; 
            varying mediump float StrengthOut;
            
            void main(void) 
            { 
                vec4 color = Color0 * texture2D(Texture0, TexCoord0); 
                float gray = dot(color.rgb, vec3(0.299, 0.587, 0.114));
                vec4 newColor = vec4(vec3(gray), 1.0);
                gl_FragColor = mix(color, newColor, StrengthOut);
            }
         ]]></fragment>
    </shader>
</shaders>